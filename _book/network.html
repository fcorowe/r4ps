<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Population Science - 5&nbsp; Network Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sentiment-analysis.html" rel="next">
<link href="./sequence-analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Population Science - 5&nbsp; Network Analysis">
<meta name="twitter:description" content="In this session we need some basic R packages before importing the data.">
<meta name="twitter:creator" content="@fcorowe">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Network Analysis</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Population Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/fcorowe/r4ps" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Population-Science.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Population-Science.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
    <a href="" title="Share" id="sidebar-tool-dropdown-1" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-1">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./privacy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Privacy, Ethics and Biases</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geodemographics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Geodemographics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sequence-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sequence Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Network Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sentiment-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sentiment Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./topic-modelling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Topic Modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling Time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assessing Interventions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Machine Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#dependencies" id="toc-dependencies" class="nav-link active" data-scroll-target="#dependencies"><span class="toc-section-number">5.1</span>  Dependencies</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="toc-section-number">5.2</span>  Data</a>
  <ul class="collapse">
  <li><a href="#the-us-census-dataset" id="toc-the-us-census-dataset" class="nav-link" data-scroll-target="#the-us-census-dataset"><span class="toc-section-number">5.2.1</span>  The US Census dataset</a></li>
  <li><a href="#import-the-data" id="toc-import-the-data" class="nav-link" data-scroll-target="#import-the-data"><span class="toc-section-number">5.2.2</span>  Import the data</a></li>
  </ul></li>
  <li><a href="#creating-networks" id="toc-creating-networks" class="nav-link" data-scroll-target="#creating-networks"><span class="toc-section-number">5.3</span>  Creating networks</a>
  <ul class="collapse">
  <li><a href="#starting-from-the-basics" id="toc-starting-from-the-basics" class="nav-link" data-scroll-target="#starting-from-the-basics"><span class="toc-section-number">5.3.1</span>  Starting from the basics</a></li>
  <li><a href="#adding-attributes" id="toc-adding-attributes" class="nav-link" data-scroll-target="#adding-attributes"><span class="toc-section-number">5.3.2</span>  Adding attributes</a></li>
  </ul></li>
  <li><a href="#reading-networks-from-data-files" id="toc-reading-networks-from-data-files" class="nav-link" data-scroll-target="#reading-networks-from-data-files"><span class="toc-section-number">5.4</span>  Reading networks from data files</a>
  <ul class="collapse">
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data"><span class="toc-section-number">5.4.1</span>  Preparing the data</a></li>
  </ul></li>
  <li><a href="#network-visualisation" id="toc-network-visualisation" class="nav-link" data-scroll-target="#network-visualisation"><span class="toc-section-number">5.5</span>  Network visualisation</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="toc-section-number">5.6</span>  </a></li>
  <li><a href="#network-metrics" id="toc-network-metrics" class="nav-link" data-scroll-target="#network-metrics"><span class="toc-section-number">5.7</span>  Network metrics</a></li>
  <li><a href="#distances-and-paths" id="toc-distances-and-paths" class="nav-link" data-scroll-target="#distances-and-paths"><span class="toc-section-number">5.8</span>  Distances and paths</a></li>
  <li><a href="#subgroups-and-communities" id="toc-subgroups-and-communities" class="nav-link" data-scroll-target="#subgroups-and-communities"><span class="toc-section-number">5.9</span>  Subgroups and communities</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/fcorowe/r4ps/edit/main/network.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-chp5" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Network Analysis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="dependencies" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="dependencies"><span class="header-section-number">5.1</span> Dependencies</h2>
<p>In this session we need some basic R packages before importing the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An R package for network manipulation and analysis</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'igraph'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    as_data_frame, groups, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    decompose, spectrum</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() <span class="co">#Obtain the working directory, where we will save the data folder</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/franciscorowe/Dropbox/Francisco/uol/teaching/envs418/202223/r4ps"</code></pre>
</div>
</div>
</section>
<section id="data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="data"><span class="header-section-number">5.2</span> Data</h2>
<section id="the-us-census-dataset" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="the-us-census-dataset"><span class="header-section-number">5.2.1</span> The US Census dataset</h3>
<p>Describe here the dataset used for this session. It has been cleaned beforehand by myself.</p>
<p>Each row corresponds to a origin-destination pair, the number or rows gives the total number of reported migratory movements.</p>
</section>
<section id="import-the-data" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="import-the-data"><span class="header-section-number">5.2.2</span> Import the data</h3>
<p>Before we start any analysis with the data, ensure to set the path to the directory where we are working. Please replace in the following line the path to the folder where you have placed the data file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/metro_to_metro_2015_2019_US_migration.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>MSA_Current_Code <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df<span class="sc">$</span>MSA_Current_Code) <span class="co">#Ensure the MSA code is imported as a character and not as a number</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df) <span class="co">#Examine the first few rows of the dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  MSA_Current_Code MSA_Current_Name MSA_Current_State
1            10180          Abilene                TX
2            10180          Abilene                TX
3            10180          Abilene                TX
4            10180          Abilene                TX
5            10180          Abilene                TX
6            10180          Abilene                TX
  MSA_Current_Population_1_Year_and_Over_Estimate
1                                         168,306
2                                         168,306
3                                         168,306
4                                         168,306
5                                         168,306
6                                         168,306
  MSA_Current_Population_1_Year_and_Over_MOE MSA_Previous_Code
1                                        300             10740
2                                        300             11100
3                                        300             12060
4                                        300             12220
5                                        300             12420
6                                        300             12580
                 MSA_Previous_Name MSA_Previous_State
1                      Albuquerque                 NM
2                         Amarillo                 TX
3 Atlanta-Sandy Springs-Alpharetta                 GA
4                   Auburn-Opelika                 AL
5     Austin-Round Rock-Georgetown                 TX
6        Baltimore-Columbia-Towson                 MD
  MSA_Previous_Population_1_Year_and_Over_Estimate
1                                          902,213
2                                          262,574
3                                        5,753,503
4                                          153,728
5                                        2,045,336
6                                        2,766,530
  MSA_Previous_Population_1_Year_and_Over_MOE
1                                       2,916
2                                       1,866
3                                       9,607
4                                       1,654
5                                       5,648
6                                       6,154
  Movers_Metro_to_Metro_Flow_Estimate Movers_Metro_to_Metro_Flow_MOE
1                                  41                             47
2                                 244                             98
3                                 118                             95
4                                  30                             40
5                                 289                             85
6                                   8                             15</code></pre>
</div>
</div>
<p>We can obtain the total number of reported migratory movements with the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52930</code></pre>
</div>
</div>
</section>
</section>
<section id="creating-networks" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="creating-networks"><span class="header-section-number">5.3</span> Creating networks</h2>
<p>Before we start to analyse the data introduced in section 5.2., let us first take a step back to consider the main object of study of this Chapter: the so-called networks. In the most general sense, a <strong>network</strong> (also known as a graph) is a structure formed by a set of objects which may have some connections between them. The objects are represented by <strong>nodes</strong> (a.k.a. vertices) and the connections between these objects are represented by <strong>edges</strong> (a.k.a. links). Networks are used as a tool to conceptualise many real-life contexts, such as the friendships between the members of a year group at school, the direct airline connections between cities in a continent or the presence of hyperlinks between a set of websites. In this session, we will use networks to model the migratory flows between US cities.</p>
<section id="starting-from-the-basics" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="starting-from-the-basics"><span class="header-section-number">5.3.1</span> Starting from the basics</h3>
<p>In order to create, manipulate and analyse networks in R, we will use the igraph package, which we imported in section 5.1. We start by creating a very simple network with the code below. The network contains five nodes and five edges and it is undirected, so the edges do not have orientations. The nodes and edges could represent, respectively, a set of cities and the presence of migration flows between these cities in two consecutive years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">graph</span>( <span class="at">edges=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">4</span>, <span class="dv">4</span>,<span class="dv">5</span>), <span class="at">n=</span><span class="dv">5</span>, <span class="at">directed=</span>F ) <span class="co"># Creates an undirected network with 5 nodes and 5 edges</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The number of nodes is given by argument n</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, the node labels or IDs are represented by numbers 1 to 5</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The edges are specified as a list of pairs of nodes</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g1) <span class="co"># A simple plot of the network allows us to visualise it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="network_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If the connections between the nodes of a network are non-reciprocal, the network is called directed. For example, this could correspond to a situation where there are people moving from city 1 to city 2, but nobody moving from city 2 to city 1. Note that in the code below we have not only added directions to the edges, but we have also added a few additional parameters to the plot function in order to customise the diagram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">graph</span>( <span class="at">edges=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">4</span>, <span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">4</span>,<span class="dv">1</span>, <span class="dv">4</span>,<span class="dv">2</span>, <span class="dv">4</span>,<span class="dv">5</span>), <span class="at">n=</span><span class="dv">7</span>, <span class="at">directed=</span>T ) <span class="co"># Creates a directed network with 7 nodes and 6 edges </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#note that we now have edge 1,4 and edge 4,1 and that 2 of the nodes are isolated</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g2, <span class="at">vertex.frame.color=</span><span class="st">"red"</span>,  <span class="at">vertex.label.color=</span><span class="st">"black"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">vertex.label.cex=</span><span class="fl">0.9</span>, <span class="at">vertex.label.dist=</span><span class="fl">2.3</span>, <span class="at">edge.curved=</span><span class="fl">0.3</span>, <span class="at">edge.arrow.size=</span>.<span class="dv">5</span>, <span class="at">edge.color =</span> <span class="st">"blue"</span>, <span class="at">vertex.color=</span><span class="st">"yellow"</span>, <span class="at">vertex.size=</span><span class="dv">15</span>) <span class="co"># A simple plot of the network with a few extra features</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="network_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The network can also be defined as a list containing pairs of named nodes. Then, it is not necessary to specify the number of nodes but the isolated nodes have to be included. The following code generates a network which is equivalent to the one above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">graph</span>( <span class="fu">c</span>(<span class="st">"City 1"</span>,<span class="st">"City 2"</span>, <span class="st">"City 2"</span>,<span class="st">"City 3"</span>, <span class="st">"City 1"</span>,<span class="st">"City 4"</span>,  <span class="st">"City 4"</span>,<span class="st">"City 1"</span>,  <span class="st">"City 4"</span>,<span class="st">"City 2"</span>, <span class="st">"City 4"</span>,<span class="st">"City 5"</span>), <span class="at">isolates=</span><span class="fu">c</span>(<span class="st">"City 6"</span>, <span class="st">"City 7"</span>) ) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g3, <span class="at">vertex.frame.color=</span><span class="st">"red"</span>,  <span class="at">vertex.label.color=</span><span class="st">"black"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">vertex.label.cex=</span><span class="fl">0.9</span>, <span class="at">vertex.label.dist=</span><span class="fl">2.3</span>, <span class="at">edge.curved=</span><span class="fl">0.3</span>, <span class="at">edge.arrow.size=</span>.<span class="dv">5</span>, <span class="at">edge.color =</span> <span class="st">"blue"</span>, <span class="at">vertex.color=</span><span class="st">"yellow"</span>, <span class="at">vertex.size=</span><span class="dv">15</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="network_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="adding-attributes" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="adding-attributes"><span class="header-section-number">5.3.2</span> Adding attributes</h3>
<p>In R, we can add attributes to the nodes, edges and the network. To add attributes to the nodes, we first need to access them via the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 7/7 vertices, named, from 90a9609:
[1] City 1 City 2 City 3 City 4 City 5 City 6 City 7</code></pre>
</div>
</div>
<p>The node attribute <em>name</em> is automatically generated from the node labels that we manually assigned before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g3)<span class="sc">$</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "City 1" "City 2" "City 3" "City 4" "City 5" "City 6" "City 7"</code></pre>
</div>
</div>
<p>But other node attributes could be added. For example, the current population of the cities represented by the nodes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g3)<span class="sc">$</span>population <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">134000</span>, <span class="dv">92000</span>, <span class="dv">549000</span>, <span class="dv">1786000</span>, <span class="dv">74000</span>, <span class="dv">8000</span>, <span class="dv">21000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, we can access the edges:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 6/6 edges from 90a9609 (vertex names):
[1] City 1-&gt;City 2 City 2-&gt;City 3 City 1-&gt;City 4 City 4-&gt;City 1 City 4-&gt;City 2
[6] City 4-&gt;City 5</code></pre>
</div>
</div>
<p>and add edge attributes, such as the number of people moving from an origin to a destination city in two consecutive years. We call this attribute the <em>weight</em> of the edge, since if there is a lot of people going from one city to another, the connection between these cities has more importance or “weight” in the network.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>{<span class="fu">E</span>(g3)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">3000</span>, <span class="dv">5000</span>, <span class="dv">1000</span>, <span class="dv">1000</span>, <span class="dv">4000</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can examine the adjacency matrix of the network, which represents the presence of edges between different pairs of nodes. In this case, each row corresponds to an origin city and each column to a destination:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>g3[] <span class="co">#The adjacency matrix of network g3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7 x 7 sparse Matrix of class "dgCMatrix"
       City 1 City 2 City 3 City 4 City 5 City 6 City 7
City 1      .   2000      .   5000      .      .      .
City 2      .      .   3000      .      .      .      .
City 3      .      .      .      .      .      .      .
City 4   1000   1000      .      .   4000      .      .
City 5      .      .      .      .      .      .      .
City 6      .      .      .      .      .      .      .
City 7      .      .      .      .      .      .      .</code></pre>
</div>
</div>
<p>We can also look at the existing node and edge attributes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex_attr</span>(g3) <span class="co">#Node attributes of g3. Use edge_attr() to access the edge attributes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$name
[1] "City 1" "City 2" "City 3" "City 4" "City 5" "City 6" "City 7"

$population
[1]  134000   92000  549000 1786000   74000    8000   21000</code></pre>
</div>
</div>
<p>Finally, it is possible to add network attributes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>g3<span class="sc">$</span>title <span class="ot">&lt;-</span> <span class="st">"Network of migration between cities"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="reading-networks-from-data-files" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="reading-networks-from-data-files"><span class="header-section-number">5.4</span> Reading networks from data files</h2>
<section id="preparing-the-data" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="preparing-the-data"><span class="header-section-number">5.4.1</span> Preparing the data</h3>
<p>At the beginning of the chapter, we defined a data frame called <em>df</em> based on some imported data from the US Census about migratory movements between different US cities, or more precisely, between US Metropolitan Statistical Areas. This is a large data frame containing 52,930 rows, but how can we turn this data frame into a network similar to the ones that we generated in section 5.3.? The igraph function <strong>graph_from_data_frame()</strong> can do this for us. To find out more about this function, we can run the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(<span class="st">"graph_from_data_frame"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we can see, the input data for <strong>graph_from_data_frame()</strong> needs to be in a certain format which is different from our migration data frame. In particular, the function requires three arguments: 1) <em>d</em>, which is a data frame containing an edge list in the first two columns and any additional columns are considered as edge attributes; 2) <em>vertices</em>, which is either NULL or a data frame with vertex metadata (i.e.&nbsp;vertex attributes); and 3) <em>directed</em>, which is a boolean argument indicating whether the network is directed or not. Our next task is therefore to obtain 1) and 2) from the migration data frame called <em>df</em>.</p>
<p>Let us start with argument 1). Each row in <em>df</em> will correspond to an edge in the migration network since it contains information about a pair of origin and destination cities for two consecutive years. The names of the origin and destination cities are given by the columns in <em>df</em> called <em>MSA_Previous_Name</em> and <em>MSA_Current_Name</em>. In addition, the column called <em>Movers_Metro_to_Metro_Flow_Estimate</em> gives the number of people moving between the origin and the destination cities, so this will be the weight attribute of each edge in the migration network. Hence, we can define a data frame of edges which we will call <em>df_edges</em> that conforms with the format required by the argument 1) as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The pipe operator used below and denoted by %&gt;% is a feature of the magrittr package, it takes the output of one function and passes it into another function as an argument</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df_edges <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df<span class="sc">$</span>MSA_Previous_Name, df<span class="sc">$</span>MSA_Current_Name, df<span class="sc">$</span>Movers_Metro_to_Metro_Flow_Estimate) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">origin =</span> df.MSA_Previous_Name, <span class="at">destination =</span> df.MSA_Current_Name, <span class="at">weight =</span> df.Movers_Metro_to_Metro_Flow_Estimate) <span class="co"># Creates the df_edges data frame with data from df and renames the columns as "origin", "destination" and "weight"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>df_edges<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,df_edges<span class="sc">$</span>weight)) <span class="co">#Ensure that the weight attribute is stored as a number and not as character </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For argument 2) we can define a data frame of nodes which we will call <em>df_nodes</em>, where each row will correspond to a unique node or city. To obtain all the unique cities from <em>df</em>, we can firstly obtain a data frame of unique origin cities, then a data frame of unique destinations, and finally, apply the <strong>full_join()</strong> function to these two data frames to obtain their union, which will be <em>df_nodes</em>. The name of the unique cities in <em>df_nodes</em> is in the column called <em>label</em>, the other columns can be seen as the nodes metadata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_unique_origins <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(MSA_Previous_Name) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">name =</span> MSA_Previous_Name) </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>df_unique_destinations <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(MSA_Current_Name) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">name =</span> MSA_Current_Name)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>df_nodes <span class="ot">&lt;-</span> <span class="fu">full_join</span>(df_unique_origins, df_unique_destinations, <span class="at">by =</span> <span class="st">"name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_nodes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                             name
1                                     Albuquerque
2                                        Amarillo
3                Atlanta-Sandy Springs-Alpharetta
4                                  Auburn-Opelika
5                    Austin-Round Rock-Georgetown
6                       Baltimore-Columbia-Towson
7                            Beaumont-Port Arthur
8                               Birmingham-Hoover
9                                     Bloomington
10                                     Boise City
11                                  Bowling Green
12                          Brownsville-Harlingen
13                    Charleston-North Charleston
14                     Charlotte-Concord-Gastonia
15                                    Chattanooga
16                                       Cheyenne
17                       Chicago-Naperville-Elgin
18                                    Clarksville
19                               Cleveland-Elyria
20                          College Station-Bryan
21                               Colorado Springs
22                                       Columbus
23                                 Corpus Christi
24             Crestview-Fort Walton Beach-Destin
25                    Dallas-Fort Worth-Arlington
26                         Denver-Aurora-Lakewood
27                        Detroit-Warren-Dearborn
28                                        El Paso
29                                           Enid
30                                           Erie
31                                   Fayetteville
32                 Fayetteville-Springdale-Rogers
33                                      Flagstaff
34                         Florence-Muscle Shoals
35                                     Fort Wayne
36                                      Goldsboro
37                            Greenville-Anderson
38                                    Hot Springs
39               Houston-The Woodlands-Sugar Land
40                                   Jacksonville
41                                 Killeen-Temple
42                              Kingsport-Bristol
43                                         Kokomo
44                                   Lake Charles
45                                         Laredo
46                                     Las Cruces
47                   Las Vegas-Henderson-Paradise
48                                         Lawton
49           Little Rock-North Little Rock-Conway
50                                          Logan
51                                       Longview
52                 Los Angeles-Long Beach-Anaheim
53                                        Lubbock
54                                      Manhattan
55                       McAllen-Edinburg-Mission
56                                        Memphis
57            Miami-Fort Lauderdale-Pompano Beach
58                                        Midland
59                                         Mobile
60                                         Monroe
61                                     Montgomery
62                                           Napa
63     Nashville-Davidson--Murfreesboro--Franklin
64                    New York-Newark-Jersey City
65                                          Ocala
66                                         Odessa
67                               Ogden-Clearfield
68                                  Oklahoma City
69                           Omaha-Council Bluffs
70                   Oxnard-Thousand Oaks-Ventura
71                  Palm Bay-Melbourne-Titusville
72                     Pensacola-Ferry Pass-Brent
73                 Philadelphia-Camden-Wilmington
74                          Phoenix-Mesa-Chandler
75                                     Rapid City
76                                        Redding
77               Riverside-San Bernardino-Ontario
78                    Sacramento-Roseville-Folsom
79                                      St. Louis
80                                          Salem
81                                 Salt Lake City
82                                     San Angelo
83                      San Antonio-New Braunfels
84                 San Diego-Chula Vista-Carlsbad
85                 San Francisco-Oakland-Berkeley
86                 San Jose-Sunnyvale-Santa Clara
87                         Santa Cruz-Watsonville
88                                       Savannah
89                        Seattle-Tacoma-Bellevue
90                                Sherman-Denison
91                        Shreveport-Bossier City
92                                    Sioux Falls
93                                    Tallahassee
94                Tampa-St. Petersburg-Clearwater
95                                      Texarkana
96                              Trenton-Princeton
97                                          Tulsa
98                                          Tyler
99                                       Valdosta
100                                       Vallejo
101                                      Victoria
102                                          Waco
103               Washington-Arlington-Alexandria
104                          Waterloo-Cedar Falls
105                                       Wichita
106                                 Wichita Falls
107                                     Worcester
108 Outside Metro Area within U.S. or Puerto Rico
109                                        Africa
110                                          Asia
111                               Central America
112                                        Europe
113                              Northern America
114                                 South America
115                    Allentown-Bethlehem-Easton
116                                       Arecibo
117                                   Baton Rouge
118                       Boston-Cambridge-Newton
119             Bremerton-Silverdale-Port Orchard
120                   Bridgeport-Stamford-Norwalk
121                    Des Moines-West Des Moines
122                                         Dover
123                                         Fargo
124                                Grand Junction
125                                       Guayama
126                  Indianapolis-Carmel-Anderson
127                             Manchester-Nashua
128                                      Mayagüez
129                            Milwaukee-Waukesha
130                     Orlando-Kissimmee-Sanford
131                                         Ponce
132                                       Reading
133                                     Rochester
134                                       Salinas
135                                    San Germán
136                      San Juan-Carolina-Caguas
137                                        Tucson
138                            Vineland-Bridgeton
139                                         Yauco
140                                     Caribbean
141                                        Albany
142                                Albany-Lebanon
143                       Albany-Schenectady-Troy
144                                       Altoona
145                                     Anchorage
146                       Augusta-Richmond County
147                                       Beckley
148                                          Bend
149                     Blacksburg-Christiansburg
150                                       Boulder
151                           Buffalo-Cheektowaga
152                     California-Lexington Park
153                              Canton-Massillon
154                         Cape Coral-Fort Myers
155                       Chambersburg-Waynesboro
156                                    Charleston
157                                    Cincinnati
158                                     Cleveland
159                                      Columbia
160                              Dayton-Kettering
161            Deltona-Daytona Beach-Ormond Beach
162                              East Stroudsburg
163                                  Fort Collins
164                         Grand Rapids-Kentwood
165                         Greensboro-High Point
166                        Hagerstown-Martinsburg
167                           Harrisburg-Carlisle
168             Hartford-East Hartford-Middletown
169                      Hickory-Lenoir-Morganton
170                   Hilton Head Island-Bluffton
171                            Huntington-Ashland
172                                       Jackson
173                             Kalamazoo-Portage
174                                   Kansas City
175                                     Knoxville
176                                     Lancaster
177                          Lansing-East Lansing
178                             Lexington-Fayette
179                                          Lima
180                   Louisville/Jefferson County
181                                       Madison
182                                     Mansfield
183              Minneapolis-St. Paul-Bloomington
184                                    Morgantown
185        Myrtle Beach-Conway-North Myrtle Beach
186                          New Orleans-Metairie
187                 North Port-Sarasota-Bradenton
188                            Norwich-New London
189                            Parkersburg-Vienna
190                                    Pittsburgh
191                       Portland-South Portland
192                  Portland-Vancouver-Hillsboro
193                                Port St. Lucie
194                                    Provo-Orem
195                                  Raleigh-Cary
196                                      Richmond
197                                       Roanoke
198                                          Rome
199                                    St. George
200                                      Santa Fe
201                     Santa Maria-Santa Barbara
202                          Sebastian-Vero Beach
203                          South Bend-Mishawaka
204                                   Springfield
205                                 State College
206                                      Syracuse
207                                   Terre Haute
208                                  The Villages
209                                        Toledo
210                                        Topeka
211                                Urban Honolulu
212                                    Utica-Rome
213           Virginia Beach-Norfolk-Newport News
214                          Weirton-Steubenville
215                                      Wheeling
216                                  Williamsport
217                                    Winchester
218                                 Winston-Salem
219                    Youngstown-Warren-Boardman
220                             U.S. Island Areas
221                            Oceania and At Sea
222                               Anniston-Oxford
223                          Athens-Clarke County
224                                     Brunswick
225                                        Dalton
226                                        Dothan
227                            Eugene-Springfield
228                                     Fairbanks
229                                      Florence
230                                   Gainesville
231                                    Hinesville
232                                   Idaho Falls
233                         Lakeland-Winter Haven
234                             Macon-Bibb County
235                                        Merced
236                                   Panama City
237                            Providence-Warwick
238                                   Rocky Mount
239                                       Saginaw
240                             Sebring-Avon Park
241                                        Sumter
242                                 Warner Robins
243                                         Akron
244                                     Asheville
245                                   Bakersfield
246                                    Bellingham
247                                 Coeur d'Alene
248                                     Corvallis
249                                     El Centro
250                                     Green Bay
251                                  Harrisonburg
252                            Kennewick-Richland
253                      Lafayette-West Lafayette
254                      Lake Havasu City-Kingman
255                                       Medford
256                                       Modesto
257                                          Reno
258                        Spokane-Spokane Valley
259                                       Visalia
260                                   Walla Walla
261                                  York-Hanover
262                       Atlantic City-Hammonton
263                                        Bangor
264                               Barnstable Town
265                                      Billings
266                                    Binghamton
267                   Burlington-South Burlington
268                                  Cedar Rapids
269                                         Chico
270                  Davenport-Moline-Rock Island
271                            Durham-Chapel Hill
272                                        Elmira
273                                    Farmington
274                                    Fort Smith
275                                        Fresno
276                                   Glens Falls
277                             Homosassa Springs
278                                        Ithaca
279                                      Kankakee
280                                      Kingston
281                                       Lebanon
282                               Lewiston-Auburn
283                                     Lynchburg
284                             New Haven-Milford
285                                     Owensboro
286                                    Pittsfield
287              Poughkeepsie-Newburgh-Middletown
288                                        Pueblo
289                                   Punta Gorda
290                                      Rockford
291                                     Salisbury
292                   San Luis Obispo-Paso Robles
293                        Scranton--Wilkes-Barre
294                                      Stockton
295                           Watertown-Fort Drum
296                                    Wilmington
297                                     Ann Arbor
298                                      Bay City
299                                        Casper
300                              Champaign-Urbana
301                                        Duluth
302                                       Greeley
303                               Gulfport-Biloxi
304                                    Huntsville
305                                     Jonesboro
306                       Kahului-Wailuku-Lahaina
307                                     Lafayette
308                                      Lawrence
309                                        Madera
310                                       Mankato
311                        Michigan City-La Porte
312                                      Missoula
313                                    Morristown
314                        Mount Vernon-Anacortes
315                        Olympia-Lacey-Tumwater
316                                        Peoria
317                      Prescott Valley-Prescott
318                           Santa Rosa-Petaluma
319                          Sierra Vista-Douglas
320                                          Yuma
321                                  Grand Island
322                               Houma-Thibodaux
323                                     Pocatello
324                             Aguadilla-Isabela
325                                      Bismarck
326                            Bloomsburg-Berwick
327                                    Burlington
328                             Carbondale-Marion
329                               Charlottesville
330                                    Gettysburg
331                                   Grants Pass
332                                     Johnstown
333                                      Lewiston
334                                       Lincoln
335                           Naples-Marco Island
336                                    Ocean City
337                                        Racine
338                                  Johnson City
339                                       Abilene
340                                      Appleton
341                                    Evansville
342                                   Grand Forks
343                                   Hattiesburg
344                                     Iowa City
345                                     Yuba City
346                                       Dubuque
347                                   Great Falls
348                                Jefferson City
349                                        Joplin
350                            La Crosse-Onalaska
351                                        Muncie
352                                     St. Cloud
353                                    St. Joseph
354                                    Sioux City
355                                   Carson City
356                                       Decatur
357                       Elizabethtown-Fort Knox
358                                       Gadsden
359                                      New Bern
360                                     Sheboygan
361                                   Spartanburg
362                                    Twin Falls
363                                 Wausau-Weston
364                                        Yakima
365                                          Ames
366                                  Battle Creek
367                                Cape Girardeau
368                                Elkhart-Goshen
369                                         Flint
370                                   Fond du Lac
371                                       Hammond
372                                      Muskegon
373                                         Niles
374                                Oshkosh-Neenah
375                                    Tuscaloosa
376                         Daphne-Fairhope-Foley
377                                      Staunton
378                                    Eau Claire
379                             Janesville-Beloit
380                                    Greenville
381                                    Alexandria
382                                     Wenatchee
383                                      Danville
384                              Hanford-Corcoran
385                                    Cumberland
386                                    Pine Bluff</code></pre>
</div>
</div>
<p>Finally, a directed migration network can be obtained with the following line of code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>US_migration_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> df_edges,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">vertices =</span> df_nodes,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="network-visualisation" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="network-visualisation"><span class="header-section-number">5.5</span> Network visualisation</h2>
<p>Once the data is imported, we need to build the network. The aim of this section is to visualise the network. To facilitate the visualisation, we will filter the dataset so that we only include cities from a state. In this case, Minnesota. To filter, we use the <strong>grepl()</strong> function, which stands for grep logical. Both <strong>grep()</strong> and <strong>grepl()</strong> allow us to check whether a pattern is present in a character string or vector of a character string. While the <strong>grep()</strong> function returns vector of indices of the element if a pattern exists in that vector, the <strong>grepl()</strong> function returns TRUE if the given pattern is present in the vector. Otherwise, it returns FALSE. In this case, we are filtering the dataset so that only the rows where the field MSA_Current_State is MN, which is the official abbreviation for Minnesota.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- df %&gt;% filter(grepl('MN', MSA_Current_State)) %&gt;% filter(grepl('MN', MSA_Previous_State))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="section"><span class="header-section-number">5.6</span> </h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(network)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># routes_network &lt;- network(edges,</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                           vertex.attr = nodes,</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                           matrix.type = "edgelist",</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ignore.eval = FALSE)</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(routes_network, vertex.cex = 2.5)</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># detach(package:network)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rm(routes_network)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(igraph)</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># routes_igraph &lt;- graph_from_data_frame(d = edges,</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                        vertices = nodes,</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                        directed = TRUE)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(routes_igraph,</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      layout = layout_with_graphopt,</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.size = 3,</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.cex = 0.7,</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">#      edge.arrow.size = 0.01)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidygraph)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggraph)</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># routes_tidy &lt;- tbl_graph(nodes = nodes,</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                          edges = edges,</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                          directed = TRUE)</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># routes_igraph_tidy &lt;- as_tbl_graph(routes_igraph)</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ggraph(routes_tidy, layout = "graphopt") + </span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_node_point() +</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_edge_link(aes(width = weight), alpha = 0.7) +</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_edge_width(range = c(0.01, 3)) +</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_node_text(aes(label = label), repel = TRUE, cex=2.5, color='red') +</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(edge_width = "Flow") +</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_graph()</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ```</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ```{r}</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co"># library(circlize)</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="co"># chordDiagram(edges, annotationTrack = "grid", preAllocateTracks = list(track.height = 0.01))</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim = get.cell.meta.data("xlim")</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   xplot = get.cell.meta.data("xplot")</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim = get.cell.meta.data("ylim")</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   sector.name = get.cell.meta.data("sector.index")</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   if(abs(xplot[2] - xplot[1]) &lt; 1000) {</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     circos.text(mean(xlim), ylim[1], sector.name, facing = "clockwise",</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                 niceFacing = TRUE, adj = c(0, 0.05), cex=0.5)</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   } else {</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     circos.text(mean(xlim), ylim[1], sector.name, facing = "clockwise",</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                 niceFacing = TRUE, adj = c(0, 0.05), cex=0.5)</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="co"># }, bg.border = NA)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(reshape2)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 &lt;- acast(edges, origin ~ destination, value.var = 'weight')</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># m1[is.na(m1)] &lt;- 0</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rownames(m1) &lt;- paste0("Origin ", 1:nrow(nodes))</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(m1) &lt;- paste0("Destination ", 1:nrow(nodes))</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># chordDiagram(m1, annotationTrack = "grid", annotationTrackHeight = c(0.04, 0.2))</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Restart circular layout parameters</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlim = get.cell.meta.data("xlim")</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   xplot = get.cell.meta.data("xplot")</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim = get.cell.meta.data("ylim")</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   sector.name = get.cell.meta.data("sector.index")</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   if(abs(xplot[2] - xplot[1]) &lt; 1000) {</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     circos.text(mean(xlim), ylim[1], sector.name, facing = "clockwise",</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                 niceFacing = TRUE, adj = c(-0.2, 0), cex=0.7)</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   } else {</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     circos.text(mean(xlim), ylim[1], sector.name, facing = "inside",</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                 niceFacing = TRUE, adj = c(0, -0.2), cex=0.7)</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="co"># }, bg.border = NA)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you want to play around and make a nicer diagram, check this <a href="https://r-graph-gallery.com/122-a-circular-plot-with-the-circlize-package.html">link</a>.</p>
</section>
<section id="network-metrics" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="network-metrics"><span class="header-section-number">5.7</span> Network metrics</h2>
<p>Now that we have visualised a small migration network, let us define some of the network</p>
</section>
<section id="distances-and-paths" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="distances-and-paths"><span class="header-section-number">5.8</span> Distances and paths</h2>
</section>
<section id="subgroups-and-communities" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="subgroups-and-communities"><span class="header-section-number">5.9</span> Subgroups and communities</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sequence-analysis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sequence Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sentiment-analysis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sentiment Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Population Science was written by Francisco Rowe, Carmen Cabrera-Arnau, Elisabetta Pietrostefani.</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>